---
- name: Run kind container
  become: "{{ kind_install_become }}"
  community.docker.docker_container:
    name: kind
    command: sleep infinity
    image: "{{ kind_install_container_registry }}/{{ kind_install_container_image }}:{{ kind_install_container_tag }}"
    env:
      USER_ID: "{{ ansible_facts.user_uid }}"
      GROUP_ID: "{{ ansible_facts.user_gid }}"
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
    state: started

- name: Copy kind script
  become: true
  ansible.builtin.copy:
    src: kind
    dest: /usr/local/bin/kind
    mode: 0755
    owner: root
    group: root
